import { Injectable, NestMiddleware } from '@nestjs/common';\nimport { Request, Response, NextFunction } from 'express';\n\n@Injectable()\nexport class SanitizationMiddleware implements NestMiddleware {\n  use(req: Request, res: Response, next: NextFunction) {\n    this.sanitizeObject(req.body);\n    this.sanitizeObject(req.query);\n    this.sanitizeObject(req.params);\n    next();\n  }\n\n  private sanitizeObject(obj: any): void {\n    if (!obj || typeof obj !== 'object') return;\n    \n    for (const key in obj) {\n      if (typeof obj[key] === 'string') {\n        obj[key] = this.sanitizeString(obj[key]);\n      } else if (typeof obj[key] === 'object') {\n        this.sanitizeObject(obj[key]);\n      }\n    }\n  }\n\n  private sanitizeString(str: string): string {\n    return str\n      .replace(/<script[^>]*>.*?<\\/script>/gi, '')\n      .replace(/<[^>]*>/g, '')\n      .replace(/javascript:/gi, '')\n      .replace(/on\\w+\\s*=/gi, '')\n      .trim();\n  }\n}\n