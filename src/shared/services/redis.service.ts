import { Injectable, Logger, OnModuleDestroy } from '@nestjs/common';\nimport { ConfigService } from '@nestjs/config';\nimport { createClient, RedisClientType } from 'redis';\n\n@Injectable()\nexport class RedisService implements OnModuleDestroy {\n  private readonly logger = new Logger(RedisService.name);\n  private client: RedisClientType;\n\n  constructor(private configService: ConfigService) {\n    this.client = createClient({\n      socket: {\n        host: this.configService.get('REDIS_HOST', 'localhost'),\n        port: this.configService.get('REDIS_PORT', 6379),\n      },\n      password: this.configService.get('REDIS_PASSWORD'),\n    });\n\n    this.client.on('error', (err) => {\n      this.logger.error('Redis Client Error', err);\n    });\n\n    this.client.connect().catch((err) => {\n      this.logger.error('Failed to connect to Redis', err);\n    });\n  }\n\n  async get(key: string): Promise<string | null> {\n    try {\n      return await this.client.get(key);\n    } catch (error) {\n      this.logger.error(`Redis GET error for key ${key}`, error);\n      return null;\n    }\n  }\n\n  async set(key: string, value: string, ttl?: number): Promise<void> {\n    try {\n      if (ttl) {\n        await this.client.setEx(key, ttl, value);\n      } else {\n        await this.client.set(key, value);\n      }\n    } catch (error) {\n      this.logger.error(`Redis SET error for key ${key}`, error);\n    }\n  }\n\n  async del(key: string): Promise<void> {\n    try {\n      await this.client.del(key);\n    } catch (error) {\n      this.logger.error(`Redis DEL error for key ${key}`, error);\n    }\n  }\n\n  async exists(key: string): Promise<boolean> {\n    try {\n      return (await this.client.exists(key)) === 1;\n    } catch (error) {\n      this.logger.error(`Redis EXISTS error for key ${key}`, error);\n      return false;\n    }\n  }\n\n  onModuleDestroy() {\n    this.client.quit();\n  }\n}\n